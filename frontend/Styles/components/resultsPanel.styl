// Results Panel Component
// 查詢結果面板組件

@import '../variables'

.results-panel
  display flex
  width 100%
  max-width 1200px
  background white
  border-radius 16px
  box-shadow panel-shadow
  padding 28px 36px
  flex-direction column
  gap 20px
  position relative
  z-index 2

  .results-title
    font-size 1.75rem
    font-weight 600
    color primary-color

  .results-description
    font-size 0.95rem
    color neutral-gray

  .results-message
    display none
    flex-direction column
    align-items center
    justify-content center
    gap 16px
    padding 40px 0
    width 100%
    border-radius 12px
    font-size 1rem
    font-weight 500
    color #143463
    text-align center
    line-height 1.6

    .results-message__illustration
      display flex
      justify-content center
      align-items center
      position relative

      &--loading
        position relative
        &::after
          content ''
          position absolute
          bottom 60px
          left 50%
          transform translateX(-50%)
          width 420px
          height 2px
          background prColor
          border-radius 999px
          opacity 0.25
          z-index 0
        @media (max-width: 768px)
          &::after
            width 70%
        @media (max-width: 480px)
          &::after
            width 70%
        img
          position relative
          z-index 1
          animation truckRoadBounce 2s ease-in-out infinite

      img
        width 200px
        height 200px
        object-fit contain

    .results-message__text
      margin 0 auto
      width 50%
      max-width 520px


  &.is-loading .results-container,
  &.is-error .results-container
    display none

  &.is-loading .results-message
    display flex

  &.is-error .results-message
    display flex
    color accent-color

  &.is-hidden
    display none

  &.is-empty
    .results-highlight
      display none
    .status-info
      display none
    .timeline-content
      display none

  .results-container
    display flex
    flex-direction row
    gap 24px

  .summary-placeholder
    display flex
    flex-direction column
    gap 16px
    padding 28px 12px
    border 1px dashed rgba(primary-color, 0.18)
    border-radius 12px
    background rgba(neutral-light, 0.35)
    text-align left

    &__title
      font-size 1.4rem
      font-weight 600
      color primary-color

    &__text
      font-size 0.95rem
      line-height 1.6
      color #415a7a

    &__accent
      display inline-flex
      align-items center
      justify-content center
      padding 4px 8px
      margin 0 4px
      border-radius 6px
      background rgba(primary-color, 0.12)
      color primary-color
      font-size 0.85rem
      font-weight 700
      letter-spacing 0.02em

    &__list
      margin 8px 0 0
      padding-left 20px
      font-size 0.9rem
      line-height 1.5
      color #4b5f7a
      list-style disc

      li
        margin-bottom 6px

    &__visual
      display flex
      justify-content center
      align-items center
      margin-bottom 8px

      .results-message__illustration
        margin-bottom 0

  .summary-placeholder--visual-only
    align-items center
    padding 40px 12px
    background none
    border none
    text-align center

    .summary-placeholder__note
      margin-top 16px
      font-size 0.95rem
      color rgba(12, 48, 88, 0.6)

  .results-highlight
    flex 6
    padding 20px 24px
    background rgba(neutral-light, 0.15)
    border 1px solid rgba(37, 99, 235, 0.12)
    border-radius 12px

    .summary-grid
      display grid
      grid-template-columns repeat(2, 1fr)
      gap 18px

      .summary-field
        display flex
        flex-direction column
        gap 6px

        .field-label
          font-size 0.75rem
          font-weight 600
          color neutral-gray
          text-transform uppercase
          letter-spacing 0.08em

        .field-value
          font-size 1.4rem
          font-weight 600
          color primary-color

  .status-info
    flex 4
    background primary-color
    border-radius 12px
    padding 20px
    display flex
    flex-direction column
    gap 20px
    position relative
    overflow hidden

    .status-placeholder
      display flex
      flex-direction column
      gap 12px
      padding 16px
      background rgba(255, 255, 255, 0.08)
      border 1px dashed rgba(255, 255, 255, 0.2)
      border-radius 12px
      color base-white

      &__title
        font-size 1.2rem
        font-weight 600

      &__text
        font-size 0.95rem
        line-height 1.6
        color rgba(255, 255, 255, 0.85)

    &::after
      content ''
      position absolute
      bottom: -20px;
      right: -20px;
      width: 50%;
      height: 80%;
      background-image url('../images/tailormed-mark.svg')
      background-size contain
      background-repeat no-repeat
      background-position bottom right
      opacity 0.15
      pointer-events none

    .summary-field
      display flex
      flex-direction column
      gap 6px
      position relative
      z-index 1
      align-items flex-start

        // 第一列（TRACKING NO.）的字體大小
        &:nth-child(1)
          .field-value
            font-size 1.4rem

      .field-label
        font-size 0.75rem
        font-weight 600
        color base-white
        text-transform uppercase
        letter-spacing 0.08em

      .field-value
        font-size 1.4rem
        font-weight 600
        color base-white

      .status-value-wrapper
        display flex
        align-items center
        gap 10px

      .status-inline
        color primary-color
        padding 5px 10px
        background secondary-color
        border-radius 5px

      .status-icon-wrapper
        position relative
        display inline-flex
        cursor pointer

        &::after
          content attr(data-tooltip)
          position absolute
          bottom 110%
          left 50%
          transform translateX(-50%)
          padding 8px 12px
          background rgba(0, 0, 0, 0.9)
          color base-white
          font-size 0.85rem
          font-weight 500
          white-space nowrap
          border-radius 6px
          opacity 0
          pointer-events none
          transition opacity 0.3s ease
          z-index 10

        &::before
          content ''
          position absolute
          bottom 100%
          left 50%
          transform translateX(-50%)
          width 0
          height 0
          border-left 6px solid transparent
          border-right 6px solid transparent
          border-top 6px solid rgba(0, 0, 0, 0.9)
          opacity 0
          pointer-events none
          transition opacity 0.3s ease

        &:hover::after,
        &:hover::before
          opacity 1

      .status-icon
        width 40px
        height 40px
        display block

      // Tracking No. (第一個欄位)
      &:nth-child(1)
        .field-value
          font-size 2.4rem

      // Last Update (第三個欄位)
      &:nth-child(3)
        .field-value
          font-size 0.8rem
          font-weight 400

        .status-badge
          display inline-flex
          align-items center
          justify-content center
          padding 10px 16px
          border-radius 999px
          font-size 0.85rem
          font-weight 700
          text-transform uppercase
          letter-spacing 0.08em
          background rgba(37, 99, 235, 0.1)
          color accent-color

          &.status-in-transit
            background rgba(37, 99, 235, 0.12)
            color accent-color

          &.status-customs
            background rgba(245, 158, 11, 0.12)
            color #f59e0b

          &.status-departed
            background rgba(187, 39, 73, 0.12)
            color accent-color

          &.status-delivered
            background rgba(187, 39, 73, 0.18)
            color #9a1f3a

          &.status-exception
            background rgba(225, 29, 72, 0.12)
            color #e11d48

  .results-note
    font-size 0.9rem
    color neutral-gray
    padding 12px 16px
    background rgba(248, 250, 252, 0.9)
    border 1px dashed rgba(12, 48, 88, 0.15)
    border-radius 12px
    text-align center

  .results-mobile-cta
    display none
    letter-spacing 0.05em
    text-transform uppercase
    font-size 1rem
    padding 0 22px
    height 55px
    border none
    border-radius 10px
    background primary-color
    color base-white
    cursor pointer
    font-weight 700
    transition transform 0.2s ease

    .btn-text
      font-size inherit
      line-height 1

    &:hover
      transform translateY(-3px)
      background darken(primary-color, 10%)

    &:active
      transform translateY(0)

  .results-summary,
  .results-list,
  .results-empty
    display none

  // Timeline Content 樣式（基礎樣式，所有尺寸下都有效）
  .timeline-content
    display flex
    flex-direction column
    gap 2rem
            margin-top 15px
    
    .timeline-title
      font-size 1.75rem
      font-weight 600
      color primary-color
      margin 0
    
    .timeline-description
      font-size 0.95rem
      color neutral-gray
      margin 0
 
     .timeline-placeholder
       margin-top 20px
       padding 18px 20px
       border-radius 12px
       border 1px dashed rgba(primary-color, 0.18)
       background rgba(neutral-light, 0.3)
 
       &__text
         margin 0
         font-size 0.9rem
         line-height 1.5
         color #3f5872
 
       &.is-hidden
         display none
 
     // Timeline Visual 樣式已移至 timelineVisual.styl
     // .timeline-visual, .timeline-track, .timeline-connector, .timeline-events 的樣式請參見 components/timelineVisual.styl
 
     .timeline-nodes-container
       display flex
       gap 1.2rem
       flex-wrap wrap
       justify-content space-between
       position relative
       z-index 2
 
       .timeline-node
         display flex
         flex-direction column
         align-items center
         text-align center
         width 120px
 
         .node-date
           display inline-flex
           align-items center
           gap 4px
 
           .month,
           .day
             font-size 1.1rem
             font-weight bold
             color primary-color
             white-space nowrap
 
         .node-icon
           display flex
           align-items center
           justify-content center
 
           .node-circle
             width 40px
             height 40px
             background primary-color
             border-radius 50%
             border 2px solid base-white
             position relative
             z-index 6
             transition all 0.3s ease
 
             &::before
               content ''
               position absolute
               top 50%
               left 50%
               transform translate(-50%, -50%)
               width 24px
               height 24px
               background base-white
               border-radius 50%
               z-index 1
 
             &::after
               content ''
               position absolute
               top 50%
               left 50%
               transform translate(-50%, -50%)
               width 10px
               height 10px
               background-image url('../images/icon-check.svg')
               background-size contain
               background-repeat no-repeat
               background-position center
               z-index 2
               filter brightness(0) saturate(100%) invert(20%) sepia(21%) saturate(1500%) hue-rotate(190deg) brightness(95%) contrast(100%)
 
             &:hover
               transform scale(1.1)
               cursor pointer
               box-shadow 0 4px 12px rgba(20, 52, 99, 0.3) !important
 
               &::before
                 background primary-color
 
               &::after
                 filter brightness(0) invert(1)
 
         .node-info
           display flex
           flex-direction column
           align-items center
 
           .node-status
             font-size 0.85rem
             font-weight 600
             color primary-color
             max-width 120px
             word-wrap break-word
             text-align center
 
           .node-time
             font-size 0.8rem
             font-weight 500
             color neutral-gray
             margin 0
 
       .timeline-node--status-1,
       .timeline-node--executed
         .node-info .node-status
           color primary-color
 
       .timeline-node--status-2,
       .timeline-node--processing
         .node-date
           .month,
           .day
             color accent-color
         .node-icon
           .node-circle
             background accent-color
             &::before
               background base-white
             &::after
               width 16px
               height 13px
               background-image url('../images/icon-truck.svg')
               filter none
             &:hover
               &::before
                 background accent-color
         .node-info .node-status
           color accent-color
           position relative
           overflow hidden
           &::before
             content ''
             position absolute
             top 0
             left -100%
             width 100%
             height 100%
             background linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)
             animation gradientShine 2s infinite
             pointer-events none
             z-index 1
             border-radius 2px
 
       .timeline-node--status-3,
       .timeline-node--international-transit
         .node-date
           .month,
           .day
             color accent-color
         .node-icon
           .node-circle
             background accent-color
             &::before
               background base-white
             &::after
               width 16px
               height 13px
               background-image url('../images/icon-inTransit.svg')
               filter none
               animation floatY 2.2s ease-in-out infinite
             &:hover
               &::before
                 background accent-color
         .node-info .node-status
           color accent-color
           position relative
           overflow hidden
           &::before
             content ''
             position absolute
             top 0
             left -100%
             width 100%
             height 100%
             background linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)
             animation gradientShine 2s infinite
             pointer-events none
             z-index 1
             border-radius 2px
 
       .timeline-node--status-4,
       .timeline-node--scheduled
         .node-date
           .month,
           .day
             color neutral-light
             font-style italic
         .node-icon
           .node-circle
             background neutral-light
             border 2px dashed neutral-light
             transition none
             pointer-events none
             &::before
               width 28px
               height 28px
               background base-white
             &::after
               display none
         .node-info .node-status,
         .node-info .node-time
           color neutral-light
 
       .timeline-node--status-5,
       .timeline-node--order-completed
         .node-date
           .month,
           .day
             color primary-color
         .node-info .node-status
           color #222
         .node-icon
           .node-circle
             &::before
               background primary-color
             &::after
               width 14px
               height 14px
               filter brightness(0) invert(1)
             transition none
             pointer-events none
 
       .timeline-node--status-6,
       .timeline-node--order-final
         .node-date
           .month,
           .day
             color primary-color
         .node-info .node-status
           color #222
         .node-info .node-time
           color neutral-gray
         .node-icon
           .node-circle
             width 58px
             height 40px
             border-radius 5px
             overflow hidden
             display flex
             align-items center
             justify-content center
             &::before
               content ''
               position absolute
               top 0
               left -100%
               width 100%
               height 100%
               background linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)
               transform skewX(20deg)
               animation orderCompletionShine 4s infinite ease-out
               pointer-events none
               z-index 1
               border-radius 3px
             &::after
               content ''
               position absolute
               top 50%
               left 50%
               transform translate(-50%, -50%)
               width 38px
               height 18px
               background-image url('../images/tailormed-mark.svg')
               background-size contain
               background-repeat no-repeat
               background-position center
               z-index 2
               filter none
             transition none
             pointer-events none
 
      .timeline-events
        position absolute
        top 0
        left 0
        width 100%
        height 100%
    
    &.timeline-preview--international:not(.timeline-preview--international-completed)
      .timeline-events
        height 99%
    
    // Timeline Icon Legend 樣式已移至 timelineIconLegend.styl
    // .timeline-icon-legend 的樣式請參見 components/timelineIconLegend.styl

// Event Dry Ice Refilled 樣式
.event-dryice-refilled
  position absolute
  display flex
  flex-direction column
  align-items center
  gap 0
  top var(--dryice-event1-top, 39%)
  left var(--dryice-event1-left, 52%)
  
  &:nth-child(2)
    top 39%
    left 66%
  
  .event-circle
    position relative
    width 16px
    height 16px
    background secondary-color
    border-radius 50%
    border 1px solid base-white
    z-index 3
    transform translateY(-50%)
    
    &::before
      content ''
      position absolute
      top 50%
      left 50%
      width 6px
      height 6px
      border-radius 50%
      background base-white
      transform translate(-50%, -50%)
    
    &::after
      content ''
      position absolute
      top 16px
      left 50%
      transform translateX(-50%)
      width 2px
      height 80px
      background secondary-color
      z-index 2
  
  .event-tag
    position relative
    background secondary-color
    color base-white
    padding 4px 8px
    border-radius 4px
    font-size 0.7rem
    font-weight normal
    white-space normal
    text-align center
    box-shadow 0 2px 4px rgba(0, 0, 0, 0.1)
    margin-top 70px
    z-index 1
    line-height 1.2
    max-width 100px
    display flex
    align-items center
    justify-content center
    
    .event-tag-text
      display block
    
    .event-tag-icon
      display none
      width 24px
      height 24px

// 動畫定義
@keyframes gradientShine
  0%
    left -100%
    opacity 0
  50%
    opacity 1
  100%
    left 100%
    opacity 0

@keyframes floatY
  0%
    transform translate(-50%, -50%) translateY(0)
  50%
    transform translate(-50%, -50%) translateY(-4px)
  100%
    transform translate(-50%, -50%) translateY(0)

@keyframes truckRoadBounce
  0%
    transform translateY(0) rotate(0deg)
  15%
    transform translateY(-6px) rotate(-0.4deg)
  30%
    transform translateY(0) rotate(0deg)
  45%
    transform translateY(-4px) rotate(0.4deg)
  60%
    transform translateY(0) rotate(0deg)
  75%
    transform translateY(-5px) rotate(-0.3deg)
  100%
    transform translateY(0) rotate(0deg)

@keyframes orderCompletionShine
  0%
    left -100%
    opacity 0
  10%
    opacity 1
  40%
    opacity 1
  50%
    left 100%
    opacity 0
  100%
    left 100%
    opacity 0

// 響應式設計
@media (max-width: 768px)
  .results-panel
    .timeline-content
      gap 1.5rem
      
      .timeline-title
        font-size 1.75rem

      .timeline-description
        font-size 0.9rem
      
      // Timeline Visual Mobile 樣式已移至 timelineVisual.styl
      // 請參見 components/timelineVisual.styl 中的 @media (max-width: 768px) 區塊
      
      .timeline-nodes-container
          flex-direction column
          gap 1.2rem
          position relative
          z-index 2
          
          .timeline-node
            flex-direction row
            align-items center
            text-align left
            gap 0
            width 100%
            margin-bottom 1.5rem
            
            &:last-child
              margin-bottom 0
            
            .node-date
              flex-direction column
              gap 2px
              padding-bottom 12px
              justify-content center
              align-items center
              width 12%
              margin-right 2%
              
              .month
                font-size 0.8rem
                font-weight normal
              
              .day
                font-size 1.4rem
                line-height 8px
            
            .node-icon
              width 17%
              display flex
              justify-content center
              align-items center
              flex-shrink 0
              
              .node-circle
                width 38px
                height 38px
                
                &::before
                  width 24px
                  height 24px
              
              // Completed 狀態的 node-circle 的 ::before 高度不同
              .node-circle--completed
                &::before
                  height 36px
            
            .node-info
              flex 1
              align-items flex-start
              margin-top 4px
              margin-left 3%
              
              .node-status
                font-size 0.9rem
                max-width 100%
                text-align left
                letter-spacing -0.1px
              
              .node-time
                font-size 0.8rem
                margin-top -4px
          
          .timeline-node--status-2 .node-date .day,
          .timeline-node--status-3 .node-date .day
            color accent-color
            font-size 1rem
            letter-spacing -1.8px
            margin-top 11px
            font-style normal
          
          .timeline-node--status-2 .node-date,
          .timeline-node--status-3 .node-date,
          .timeline-node--status-4 .node-date
            position relative
            padding-bottom 12px
            
            &::after
              content attr(data-month)
              display block
              text-align center
              font-weight 600
              font-size 1rem
            
            .month
              display none
            
            .day
              display none
          
          .timeline-node--status-2 .node-date::after,
          .timeline-node--status-3 .node-date::after
            color accent-color
          
          .timeline-node--status-4 .node-date::after
            color neutral-light
            font-style italic
          
          .timeline-node--status-4 .node-date .month,
          .timeline-node--status-4 .node-date .day
            color neutral-light
            font-size 1rem
            letter-spacing -1.8px
            margin-top 6px
            font-style italic
          
          .timeline-node--status-6 .node-icon
            width 58px
          
          .timeline-node--status-6 .node-circle
            width 58px
            height 40px
            
            &::after
              width 38px
              height 18px
      
      // Timeline Icon Legend Mobile 樣式已移至 timelineIconLegend.styl
      // 請參見 components/timelineIconLegend.styl 中的 @media (max-width: 768px) 區塊
  
@media (max-width: 768px)
  .timeline-preview--international .timeline-visual,
  .results-panel .timeline-content .timeline-visual.timeline-visual--imex
    &.timeline-visual--order-final
      .timeline-events
        height 100%
    &:not(.timeline-visual--order-final)
      .timeline-events
        height 99%
    --dryice-event1-top 55%
    --dryice-event1-left 20%
  .event-dryice-refilled
    position absolute
    display flex
    flex-direction row
    align-items center
    gap 12px
    width fit-content
    
    &:nth-child(1)
      top 55%
      left 20%
    
    &:nth-child(2)
      top 70.5%
      left 20%
    
    .event-circle
      transform none
      flex-shrink 0
      z-index 3
      
      &::after
        content ''
        position absolute
        top 50%
        left 16px
        transform translateY(-50%)
        width 60px
        height 2px
        background secondary-color
        z-index 2
    
    .event-tag
      margin-top 0
      margin-left 58px
      white-space nowrap
      z-index 1
      max-width none
      width 24px
      height 24px
      padding 0
      border-radius 0
      background transparent
      box-shadow none
      
      .event-tag-text
        display none
      
      .event-tag-icon
        display block
        width 35px
        height 35px
        cursor pointer
        position relative
        
        &::after
          content 'Dry ice refilled'
          position absolute
          top auto
          bottom 130%
          left 50%
          transform translateX(-50%)
          padding 6px 10px
          background rgba(0, 0, 0, 0.9)
          color base-white
          font-size 0.75rem
          font-weight 500
          white-space nowrap
          border-radius 4px
          opacity 0
          pointer-events none
          transition opacity 0.3s ease
          z-index 10
        
        &::before
          content ''
          position absolute
          top auto
          bottom 127%
          left 50%
          transform translateX(-50%)
          width 0
          height 0
          border-left 4px solid transparent
          border-right 4px solid transparent
          border-top 4px solid rgba(0, 0, 0, 0.9)
          opacity 0
          pointer-events none
          transition opacity 0.3s ease
        
        &:hover::after,
        &:hover::before
          opacity 1

@media (max-width: 768px)
  .timeline-preview
    .timeline-node--status-2 .node-date,
    .timeline-node--status-3 .node-date,
    .timeline-node--status-4 .node-date
      &::after
        content attr(data-month)
        display block
        text-align center
        font-weight 600
        font-size 1rem
        margin-top 15px
      .month
        display none
      .day
        display none
    .timeline-node--status-2 .node-date::after,
    .timeline-node--status-3 .node-date::after
      color accent-color
    .timeline-node--status-4 .node-date::after
      color neutral-light
      font-style italic

@media (max-width: 768px)
  .results-panel
    .results-highlight
      .summary-grid
        grid-template-columns repeat(1, 1fr)

@media (max-width: 768px)
  .results-panel
    .results-container
      flex-direction column

@media (max-width: 480px)
  .results-panel
    padding 28px 24px
  .event-dryice-refilled[data-step='4']
    top 54.5%
    left 20%
  .event-dryice-refilled[data-step='5']
    top 70%
    left 20%
// Mobile Extra Styles

// Shared timeline preview styling outside results panel
.timeline-preview
  .timeline-nodes-container
    display flex
    gap 1.2rem
    flex-wrap wrap
    justify-content space-between
    position relative
    z-index 2

    .timeline-node
      display flex
      flex-direction column
      align-items center
      text-align center

      .node-date
        display inline-flex
        align-items center
        gap 4px
        position relative

        .month,
        .day
          font-size 1.1rem
          font-weight bold
          color primary-color
          white-space nowrap

      .node-icon
        display flex
        align-items center
        justify-content center

        .node-circle
          width 40px
          height 40px
          background primary-color
          border-radius 50%
          border 2px solid base-white
          position relative
          z-index 6
          transition all 0.3s ease

          &::before
            content ''
            position absolute
            top 50%
            left 50%
            transform translate(-50%, -50%)
            width 24px
            height 24px
            background base-white
            border-radius 50%
            z-index 1

          &::after
            content ''
            position absolute
            top 50%
            left 50%
            transform translate(-50%, -50%)
            width 10px
            height 10px
            background-image url('../images/icon-check.svg')
            background-size contain
            background-repeat no-repeat
            background-position center
            z-index 2
            filter brightness(0) saturate(100%) invert(20%) sepia(21%) saturate(1500%) hue-rotate(190deg) brightness(95%) contrast(100%)
      
      &.timeline-node--status-6
        .node-icon
          .node-circle
            width 58px
            height 40px
            border-radius 5px
            overflow hidden
            display flex
            align-items center
            justify-content center
            border 0
            &::before
              content ''
              position absolute
              top 0
              left -100%
              width 100%
              height 100%
              background linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)
              transform skewX(20deg)
              animation orderCompletionShine 4s infinite ease-out
              pointer-events none
              z-index 1
              border-radius 3px
            &::after
              content ''
              position absolute
              top 50%
              left 50%
              transform translate(-50%, -50%)
              width 38px
              height 18px
              background-image url('../images/tailormed-mark.svg')
              background-size contain
              background-repeat no-repeat
              background-position center
              z-index 2
              filter none
            transition none
            pointer-events none
